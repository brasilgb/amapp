import{q as E,r as g,j as e,a as U,y as I}from"./app-GmlYUa64.js";import{C as B,a as R,b as D,c as O}from"./card-CdD9FVyH.js";import{A as P}from"./AdminLayout-Cia5KSwi.js";import{z as l,u as T,F as $,a as i,b as o,c as d,d as x,I as h,e as j,L as q,S as H,t as J}from"./input-BrFPhO40.js";import{B as f}from"./button-CVl-hmtQ.js";import{S as v,a as N,b,c as S,d as y}from"./select-_LHzKT0G.js";import{A as M,r as G,s as K}from"./dataSelect-CsWYKT-O.js";import{U as Q}from"./user-round-CJ3AmHoF.js";import{E as _,a as V}from"./eye-CmvGOZVP.js";import"./index-CykULU2U.js";import"./createLucideIcon-Cl0mVLva.js";import"./index-DwMD5fcq.js";import"./sliders-horizontal-Bw3jIO2z.js";const W=l.object({organization_id:l.string().min(1,{message:"Selecione a organização"}),company_id:l.string().refine(n=>n.organization_id!==null,{message:"Selecione a filial"}),organization:l.string().min(1,{message:"Selecione a organização"}),name:l.string().min(1,{message:"Digite um nome"}),email:l.string().min(1,{message:"Digite o CNPJ"}),roles:l.string().min(1,{message:"Selecione oa função"}),status:l.string().min(1,{message:"Selecione o status"}),password:l.string().min(8,{message:"A senha deve ter no mínimo 8 caracteres"}),password_confirmation:l.string().min(8,{message:"A senha deve ter no mínimo 8 caracteres"})}).refine(n=>n.password===n.password_confirmation,{message:"As senhas são diferentes",path:["password_confirmation"]}),me=({organizations:n})=>{const{auth:C,errors:t}=E().props,[F,X]=g.useState(!1),[u,w]=g.useState([]),[m,z]=g.useState(!1),r=T({resolver:J(W),defaultValues:{organization_id:"",company_id:"",organization:"",name:"",email:"",password:"",roles:"",status:"",password_confirmation:""}});function k(s){console.log(s),I.post(route("users.store"),s)}const L=s=>{if(r.setValue("organization",s),s.length>2){const a=s.toLowerCase(),c=n==null?void 0:n.filter(p=>p.name.toLowerCase().includes(a));w(c)}},A=(s,a)=>{r.setValue("organization_id",`${s}`),r.setValue("organization",a),w([])};return e.jsx(P,{children:e.jsx("div",{className:"p-4 bg-background",children:e.jsxs(B,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[e.jsxs("div",{className:"flex text-gray-600",children:[e.jsx(Q,{size:28,className:"mr-1 "}),e.jsx(D,{className:"text-lg sm:text-xl select-none uppercase",children:"Usuários"})]}),e.jsxs(U,{href:route("users.index"),className:`flex h-9 w-9 shrink-0 items-center justify-center rounded-lg
                                         bg-green-700 hover:bg-green-700/90 text-white transition-colors hover:text-gray-100`,children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Voltar aos Usuários"})]})]})}),e.jsx(O,{children:e.jsx("div",{children:e.jsx($,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(k),className:"space-y-8",autoComplete:"off",children:[e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 mt-4",children:[C.user.organization_id!==null&&e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"company_id",render:({field:s})=>{var a;return e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Função do usuário"}),e.jsxs(v,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(N,{className:"",children:e.jsx(b,{placeholder:"Selecione a filial"})}),e.jsx(S,{children:(a=n[0].company)==null?void 0:a.map((c,p)=>e.jsx(y,{value:c.subnumber,children:c.altername},p))})]})]})}})}),C.user.organization_id===null&&e.jsxs("div",{className:"relative",children:[e.jsx(i,{control:r.control,name:"organization_id",render:({field:s})=>e.jsxs(o,{className:"hidden",children:[e.jsx(x,{children:e.jsx(h,{...s,value:s.value})}),e.jsx(j,{})]})}),e.jsx(i,{control:r.control,name:"organization",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Organização"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s,value:s.value,onChange:a=>L(a.target.value)})}),e.jsx(j,{})]})}),u.length>0&&e.jsx("div",{className:"absolute z-20 bg-gray-50 border-2 border-white shadow-md w-full rounded-sm top-16 max-h-52 overflow-y-auto",children:e.jsx("ul",{className:"p-1",children:u.map((s,a)=>e.jsx("li",{className:`flex items-center justify-normal ${a<u.length-1?"border-b border-gray-200":""}`,children:e.jsx("div",{className:"text-sm text-gray-600 p-1 cursor-pointer inline-block w-full",onClick:()=>A(s.id,s.name),children:s.name})},a))})})]}),e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"name",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Nome"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})}),e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"email",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"E-mail"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"password",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{children:e.jsx(h,{type:m?"text":"password",placeholder:"",...s})}),e.jsx(f,{type:"button",className:"absolute right-0.5 top-0.5",onClick:()=>z(!m),size:"icon",variant:"link",children:m?e.jsx(_,{}):e.jsx(V,{})})]}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})}),e.jsx("div",{children:e.jsx(i,{control:r.control,name:"password_confirmation",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Repita a senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{children:e.jsx(h,{type:m?"text":"password",placeholder:"",...s})}),e.jsx(f,{type:"button",className:"absolute right-0.5 top-0.5",onClick:()=>z(!m),size:"icon",variant:"link",children:m?e.jsx(_,{}):e.jsx(V,{})})]}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"roles",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Função do usuário"}),e.jsxs(v,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(N,{className:"",children:e.jsx(b,{placeholder:"Selecione a função"})}),e.jsx(S,{children:G.map((a,c)=>e.jsx(y,{value:a.value,children:a.label},c))})]})]})})}),e.jsx("div",{className:"",children:e.jsx(i,{control:r.control,name:"status",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Status"}),e.jsxs(v,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(N,{className:"",children:e.jsx(b,{placeholder:"Selecione o status"})}),e.jsx(S,{children:K.map((a,c)=>e.jsx(y,{value:a.value,children:a.label},c))})]})]})})})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs(f,{className:"flex gap-2 bg-blue-600 hover:bg-blue-600/90",type:"submit",children:[F?e.jsx(q,{size:18,className:"animate-spin"}):e.jsx(H,{size:18}),e.jsx("span",{children:"Salvar"})]})})]})})})})]})})})};export{me as default};
