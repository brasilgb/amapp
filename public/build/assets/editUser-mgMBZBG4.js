import{q as I,r as f,j as e,a as B,y as O}from"./app-C4qh0mEh.js";import{C as R,a as D,b as P,c as T}from"./card-DFwncd-S.js";import{A as $}from"./AdminLayout-B47u4XNS.js";import{z as r,u as q,t as H,F as J,a as i,b as o,c as d,d as x,I as h,e as j,L as M,S as G}from"./input-DxaNGCZS.js";import{B as v}from"./button-B8sZM8AG.js";import{S as N,a as b,b as y,c as S,d as C}from"./select-BhaTQ6fu.js";import{A as K,r as Q,s as W}from"./dataSelect-p6zyfI1S.js";import{U as X}from"./user-round-CqxQSba0.js";import{C as Y}from"./index-CAB0cIM5.js";import{E as F,a as k}from"./eye-CCeI9ZAZ.js";import"./index-C-cBhlU4.js";import"./createLucideIcon-Cj5ilMqY.js";import"./sliders-horizontal-CTbylhgT.js";const Z=r.object({organization_id:r.any().optional(),company_id:r.any().optional(),organization:r.string().min(1,{message:"Selecione a organização"}),name:r.string().min(1,{message:"Digite um nome"}),email:r.string().min(1,{message:"Digite o CNPJ"}),roles:r.string().min(1,{message:"Selecione oa função"}),status:r.string().min(1,{message:"Selecione o status"}),password:r.string().optional(),password_confirmation:r.string().optional()}).refine(m=>m.password===m.password_confirmation,{message:"As senhas são diferentes",path:["password_confirmation"]}),je=({organizations:m,user:n})=>{const{auth:w,errors:t,flash:_}=I().props,[L,ee]=f.useState(!1),[p,z]=f.useState([]),[u,V]=f.useState(!1),l=q({resolver:H(Z),defaultValues:{organization_id:n.organization_id&&n.organization_id.toString(),company_id:n.company_id,organization:n.organization_id?n.organization.name:"Automágico",name:n.name,email:n.email,roles:n.roles,status:n.status,password:"",password_confirmation:""}});function A(s){O.patch(route("users.update",n.id),s)}const E=s=>{if(l.setValue("organization",s),s.length>2){const a=s.toLowerCase(),c=m==null?void 0:m.filter(g=>g.name.toLowerCase().includes(a));z(c)}},U=(s,a)=>{l.setValue("organization_id",`${s}`),l.setValue("organization",a),z([])};return e.jsx($,{children:e.jsx("div",{className:"p-4 bg-background",children:e.jsxs(R,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[e.jsxs("div",{className:"flex text-gray-600",children:[e.jsx(X,{size:28,className:"mr-1 "}),e.jsx(P,{className:"text-lg sm:text-xl select-none uppercase",children:"Usuários"})]}),e.jsxs(B,{href:route("users.index"),className:`flex h-9 w-9 shrink-0 items-center justify-center rounded-lg
                                         bg-green-700 hover:bg-green-700/90 text-white transition-colors hover:text-gray-100`,children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Voltar aos Usuários"})]})]})}),e.jsxs(T,{children:[_.message&&e.jsxs("div",{className:"bg-green-500 text-white text-sm font-semibold flex items-center justify-start gap-1 p-2 rounded-md transition-all duration-300",children:[e.jsx(Y,{className:"w-4 h-4"})," ",_.message]}),e.jsx("div",{children:e.jsx(J,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(A),className:"space-y-8",children:[e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 mt-4",children:[w.user.organization_id!==null&&e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"company_id",render:({field:s})=>{var a;return e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Filial do usuário"}),e.jsxs(N,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(b,{className:"",children:e.jsx(y,{placeholder:"Selecione a filial"})}),e.jsx(S,{children:(a=m[0].company)==null?void 0:a.map((c,g)=>e.jsx(C,{value:c.subnumber,children:c.altername},g))})]})]})}})}),w.user.organization_id===null&&e.jsxs("div",{className:"relative",children:[e.jsx(i,{control:l.control,name:"organization_id",render:({field:s})=>e.jsxs(o,{className:"hidden",children:[e.jsx(x,{children:e.jsx(h,{...s,value:s.value})}),e.jsx(j,{})]})}),e.jsx(i,{control:l.control,name:"organization",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Organização"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s,value:s.value,onChange:a=>E(a.target.value),readOnly:n.organization_id===null})}),e.jsx(j,{})]})}),p.length>0&&e.jsx("div",{className:"absolute z-20 bg-gray-50 border-2 border-white shadow-md w-full rounded-sm top-16 max-h-52 overflow-y-auto",children:e.jsx("ul",{className:"p-1",children:p.map((s,a)=>e.jsx("li",{className:`flex items-center justify-normal ${a<p.length-1?"border-b border-gray-200":""}`,children:e.jsx("div",{className:"text-sm text-gray-600 p-1 cursor-pointer inline-block w-full",onClick:()=>U(s.id,s.name),children:s.name})},a))})})]}),e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"name",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Nome"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})}),e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"email",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"E-mail"}),e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"password",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),e.jsx(v,{type:"button",className:"absolute right-0.5 top-0.5",onClick:()=>V(!u),size:"icon",variant:"link",children:u?e.jsx(F,{}):e.jsx(k,{})})]}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})}),e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"password_confirmation",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Repita a senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{children:e.jsx(h,{placeholder:"",...s})}),e.jsx(v,{type:"button",className:"absolute right-0.5 top-0.5",onClick:()=>V(!u),size:"icon",variant:"link",children:u?e.jsx(F,{}):e.jsx(k,{})})]}),t.cnpj&&e.jsx("div",{className:"text-red-600 text-sm font-medium",children:t.cnpj}),e.jsx(j,{})]})})})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mt-4",children:[e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"roles",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Função do usuário"}),e.jsxs(N,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(b,{className:"",children:e.jsx(y,{placeholder:"Selecione a função"})}),e.jsx(S,{children:Q.map((a,c)=>e.jsx(C,{value:a.value,children:a.label},c))})]})]})})}),e.jsx("div",{className:"",children:e.jsx(i,{control:l.control,name:"status",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(d,{children:"Status"}),e.jsxs(N,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,children:[e.jsx(b,{className:"",children:e.jsx(y,{placeholder:"Selecione o status"})}),e.jsx(S,{children:W.map((a,c)=>e.jsx(C,{value:a.value,children:a.label},c))})]})]})})})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs(v,{className:"flex gap-2 bg-blue-600 hover:bg-blue-600/90",type:"submit",children:[L?e.jsx(M,{size:18,className:"animate-spin"}):e.jsx(G,{size:18}),e.jsx("span",{children:"Salvar"})]})})]})})})]})]})})})};export{je as default};
